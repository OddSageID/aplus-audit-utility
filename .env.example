# ============================================
# A+ System Audit Utility - Configuration
# ============================================
# Author: Kevin Hormaza
# GitHub: https://github.com/OddSageID
# Course: Technical Support Fundamentals - Final Project
# Institution: Finger Lakes Community College

# ──────────────────────────────────────────
# AI Provider Configuration (Required)
# ──────────────────────────────────────────
# For Anthropic Claude (Recommended for this project)
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxx

# OR for OpenAI GPT (Alternative)
# Get your API key from: https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxx

# ──────────────────────────────────────────
# Database Configuration (Optional)
# ──────────────────────────────────────────
# SQLite (Default - no setup required, embedded database)
DATABASE_URL=sqlite:///./audit_history.db

# PostgreSQL (Production - recommended for enterprise deployments)
# Requires: pip install psycopg2-binary
# DATABASE_URL=postgresql://user:password@localhost:5432/audit_db

# MySQL (Alternative - compatible but not recommended)
# Requires: pip install pymysql
# DATABASE_URL=mysql://user:password@localhost:3306/audit_db

# ──────────────────────────────────────────
# Rate Limiting Configuration (Optional)
# ──────────────────────────────────────────
# Controls API request throttling to prevent quota exhaustion
MAX_REQUESTS_PER_MINUTE=60
MAX_REQUESTS_PER_HOUR=1000
MAX_CONCURRENT_REQUESTS=5

# Circuit breaker thresholds
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=2
CIRCUIT_BREAKER_TIMEOUT_SECONDS=60

# ──────────────────────────────────────────
# Logging Configuration (Optional)
# ──────────────────────────────────────────
# Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file location (leave empty for console-only logging)
# LOG_FILE=./logs/audit.log

# Enable detailed logging for troubleshooting
# LOG_VERBOSE=false

# ──────────────────────────────────────────
# Output Configuration (Optional)
# ──────────────────────────────────────────
# Directory for audit reports and results
OUTPUT_DIR=./audit_results

# Report formats (comma-separated): html, json, prometheus, cloudwatch
REPORT_FORMATS=html,json

# Enable pretty-printing for JSON output
JSON_INDENT=2

# ──────────────────────────────────────────
# Feature Toggles (Optional)
# ──────────────────────────────────────────
# Enable database persistence for audit history
ENABLE_DATABASE=true

# Enable metrics collection and export
ENABLE_METRICS=true

# Enable AI-powered analysis (requires API key)
ENABLE_AI_ANALYSIS=true

# Generate remediation scripts for findings
GENERATE_REMEDIATION=true

# Enable parallel collector execution for faster audits
ENABLE_PARALLEL_EXECUTION=true

# ──────────────────────────────────────────
# Security Configuration (Optional)
# ──────────────────────────────────────────
# Require administrator/root privileges for security checks
# Set to false for testing without elevated permissions
REQUIRE_ADMIN=true

# Enable SHA-256 integrity verification of audit results
ENABLE_INTEGRITY_CHECK=true

# Enable input validation for all user inputs and API responses
ENABLE_INPUT_VALIDATION=true

# ──────────────────────────────────────────
# Audit Configuration (Optional)
# ──────────────────────────────────────────
# CIS Benchmark compliance level (1 or 2)
CIS_LEVEL=1

# Timeout for individual collector execution (seconds)
COLLECTOR_TIMEOUT=300

# Maximum findings per audit (prevents excessive output)
MAX_FINDINGS_PER_AUDIT=100

# Enable custom security checks (beyond CIS Benchmarks)
ENABLE_CUSTOM_CHECKS=true

# ──────────────────────────────────────────
# AI Model Configuration (Optional)
# ──────────────────────────────────────────
# AI provider: anthropic or openai
AI_PROVIDER=anthropic

# Model selection (affects cost and performance)
# Anthropic options: claude-3-5-haiku-20241022, claude-3-5-sonnet-20241022, claude-3-opus-20240229
# OpenAI options: gpt-4o-mini, gpt-4o, gpt-4-turbo
AI_MODEL=claude-3-5-haiku-20241022

# AI temperature (0.0-1.0, lower = more deterministic)
AI_TEMPERATURE=0.3

# Maximum tokens for AI response
AI_MAX_TOKENS=4000

# ──────────────────────────────────────────
# Monitoring & Alerting (Optional)
# ──────────────────────────────────────────
# Enable Prometheus metrics export
ENABLE_PROMETHEUS=false
PROMETHEUS_PORT=9090

# Enable CloudWatch metrics export (requires AWS credentials)
ENABLE_CLOUDWATCH=false
CLOUDWATCH_NAMESPACE=AuditUtility
CLOUDWATCH_REGION=us-east-1

# Alert thresholds
ALERT_RISK_SCORE_THRESHOLD=75
ALERT_CRITICAL_FINDINGS_THRESHOLD=3

# ──────────────────────────────────────────
# Development & Testing (Optional)
# ──────────────────────────────────────────
# Enable debug mode (verbose logging, no API calls)
# DEBUG_MODE=false

# Dry run mode (collect data but don't save to database)
# DRY_RUN=false

# Mock API responses for testing without API key
# MOCK_AI_RESPONSES=false

# ──────────────────────────────────────────
# Advanced Configuration (Optional)
# ──────────────────────────────────────────
# Custom collectors directory (for plugin-style extensions)
# CUSTOM_COLLECTORS_PATH=./custom_collectors

# Cache directory for API responses
# CACHE_DIR=./.cache

# Cache TTL in seconds (0 = disabled)
# CACHE_TTL=3600

# ──────────────────────────────────────────
# Notes
# ──────────────────────────────────────────
# 1. Copy this file to .env and configure values
# 2. Never commit .env to version control (listed in .gitignore)
# 3. API keys should be kept secret and rotated regularly
# 4. For production deployments, use PostgreSQL instead of SQLite
# 5. Enable rate limiting in production to prevent API quota exhaustion
# 6. See README.md for detailed configuration documentation
